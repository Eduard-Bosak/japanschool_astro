# Bugfix Update - October 3, 2025

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤

**–í–µ—Ä—Å–∏—è:** 2.1.1 (Bugfix Release)

---

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏

### 1. ‚ùå –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞–ª–æ —á–µ—Ä–µ–∑ 6 —Ç–µ–º –≤–º–µ—Å—Ç–æ 2

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –¢–µ–º–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–ª–∞—Å—å —á–µ—Ä–µ–∑: `dark ‚Üí light ‚Üí spring ‚Üí autumn ‚Üí winter ‚Üí sakura`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª —Å–ª—É—á–∞–π–Ω—ã–µ —Ü–≤–µ—Ç–∞ (—Å–∏–Ω–∏–π, –∑–µ–ª—ë–Ω—ã–π –∏ —Ç.–¥.)
- –ù–∞ 5-–π —Ä–∞–∑ —Ç–æ–ª—å–∫–æ –ø–æ—è–≤–ª—è–ª–∞—Å—å —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞

**–ü—Ä–∏—á–∏–Ω–∞:**

```javascript
// theme.js (–¥–æ)
const themeOrder = ['dark', 'light', 'spring', 'autumn', 'winter', 'sakura'];
```

**–†–µ—à–µ–Ω–∏–µ:**

```javascript
// theme.js (–ø–æ—Å–ª–µ)
export function cycleTheme() {
  const current = root.getAttribute('data-theme') || 'dark';
  const next = current === 'dark' ? 'light' : 'dark';

  root.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);

  track('theme_toggle', { to: next, mode: 'toggle' });
}
```

‚úÖ –¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: `dark ‚áÑ light`

---

### 2. ‚ùå –ü–∞–¥–∞—é—â–∞—è —Å–∞–∫—É—Ä–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞—Å—å –≤ –±–ª–æ–≥–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –°–∞–∫—É—Ä–∞ –±—ã–ª–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- –í –±–ª–æ–≥–µ `<canvas id="sakura-canvas">` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª

**–ü—Ä–∏—á–∏–Ω–∞:**

```html
<!-- build.mjs —à–∞–±–ª–æ–Ω –±–ª–æ–≥–∞ (–¥–æ) -->
<body>
  <div class="reading-progress">...</div>
  <!-- canvas –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª -->
</body>
```

**–†–µ—à–µ–Ω–∏–µ:**

```html
<!-- build.mjs —à–∞–±–ª–æ–Ω –±–ª–æ–≥–∞ (–ø–æ—Å–ª–µ) -->
<body>
  <canvas id="sakura-canvas" aria-hidden="true"></canvas>
  <div class="reading-progress">...</div>
</body>
```

‚úÖ –¢–µ–ø–µ—Ä—å —Å–∞–∫—É—Ä–∞ –ø–∞–¥–∞–µ—Ç –≤–µ–∑–¥–µ (–≥–ª–∞–≤–Ω–∞—è + –±–ª–æ–≥)

---

### 3. ‚ùå –ö–Ω–æ–ø–∫–∏ A-/A+ —Ä–∞–±–æ—Ç–∞–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü–µ—Ä–≤–æ–µ –Ω–∞–∂–∞—Ç–∏–µ A+ ‚Üí OK (—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç)
- –í—Ç–æ—Ä–æ–µ –Ω–∞–∂–∞—Ç–∏–µ A+ ‚Üí –≤—Å—ë —Å–ª–µ—Ç–∞–µ—Ç (—Ä–µ–∂–∏–º –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è)
- A- –Ω–µ —Ä–∞–±–æ—Ç–∞–ª –ø–æ—Å–ª–µ A+

**–ü—Ä–∏—á–∏–Ω–∞:**

```javascript
// –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ (–¥–æ)
btn.addEventListener('click', () => {
  if (['small', 'large'].includes(mode)) {
    ['small', 'large'].forEach((m) => {
      if (m !== mode) {
        modes.delete(m); // –£–¥–∞–ª—è–µ–º –¥—Ä—É–≥–∏–µ —Ä–∞–∑–º–µ—Ä—ã
      }
    });
  }

  if (modes.has(mode)) {
    modes.delete(mode); // –ó–∞—Ç–µ–º —É–¥–∞–ª—è–µ–º —Ç–µ–∫—É—â–∏–π
    btn.classList.remove('active');
  } else {
    modes.add(mode);
    btn.classList.add('active');
  }
});
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö —Ä–∞–∑–º–µ—Ä–æ–≤, —Å—Ä–∞–∑—É –∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
`modes.has(mode)` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `false`, —Ä–µ–∂–∏–º –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ, –Ω–æ –∫–Ω–æ–ø–∫–∞ —É–∂–µ
–Ω–µ active.

**–†–µ—à–µ–Ω–∏–µ:**

```javascript
// –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ (–ø–æ—Å–ª–µ)
btn.addEventListener('click', () => {
  const isSize = ['small', 'large'].includes(mode);
  const wasActive = modes.has(mode); // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –î–û –æ—á–∏—Å—Ç–∫–∏

  if (isSize) {
    // –û—á–∏—â–∞–µ–º –≤—Å–µ —Ä–∞–∑–º–µ—Ä—ã
    ['small', 'large'].forEach((m) => {
      modes.delete(m);
      document.body.classList.remove('reading-mode-' + m);
      const other = document.querySelector('[data-mode="' + m + '"]');
      if (other) other.classList.remove('active');
    });
  }

  // –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–∞ - –ø—Ä–æ—Å—Ç–æ –≤—ã—Ö–æ–¥–∏–º (—É–∂–µ —É–¥–∞–ª–∏–ª–∏)
  if (wasActive && isSize) {
    return;
  }

  // –ï—Å–ª–∏ –ù–ï –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–∞ - –¥–æ–±–∞–≤–ª—è–µ–º
  if (!wasActive) {
    modes.add(mode);
    document.body.classList.add('reading-mode-' + mode);
    btn.classList.add('active');
  }

  localStorage.setItem(KEY, JSON.stringify([...modes]));
});
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

| –î–µ–π—Å—Ç–≤–∏–µ              | wasActive | isSize | –†–µ–∑—É–ª—å—Ç–∞—Ç                      |
| --------------------- | --------- | ------ | ------------------------------ |
| –ù–∞–∂–∞–ª A- (–ø–µ—Ä–≤—ã–π —Ä–∞–∑) | false     | true   | –î–æ–±–∞–≤–ª—è–µ—Ç small, –∫–Ω–æ–ø–∫–∞ active |
| –ù–∞–∂–∞–ª A+              | false     | true   | –£–¥–∞–ª—è–µ—Ç small, –¥–æ–±–∞–≤–ª—è–µ—Ç large |
| –ù–∞–∂–∞–ª A+ (–ø–æ–≤—Ç–æ—Ä–Ω–æ)   | true      | true   | –£–¥–∞–ª—è–µ—Ç large, return (–≤—ã—Ö–æ–¥)  |
| –ù–∞–∂–∞–ª A-              | false     | true   | –î–æ–±–∞–≤–ª—è–µ—Ç small                |

‚úÖ –¢–µ–ø–µ—Ä—å –∫–Ω–æ–ø–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–µ, –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ = –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ

---

## üì¶ Build Output

```bash
[build] done: styles.b2c00e0fee.css main.d2c58d7a30.js
```

**–ù–æ–≤—ã–µ —Ö–µ—à–∏:**

- CSS: `b2c00e0fee` (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- JS: `d2c58d7a30` (–æ–±–Ω–æ–≤–ª—ë–Ω JS —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏)

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã:

```
–ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É ‚Üí Dark ‚Üí Light
–ù–∞–∂–∞—Ç—å —Å–Ω–æ–≤–∞   ‚Üí Light ‚Üí Dark
```

### –ü–∞–¥–∞—é—â–∞—è —Å–∞–∫—É—Ä–∞:

- ‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (`/`)
- ‚úÖ –ë–ª–æ–≥ (`/blog/japanese-etiquette/`)
- ‚úÖ Canvas –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `sakura.init()`
- ‚úÖ 30 –ª–µ–ø–µ—Å—Ç–∫–æ–≤ –Ω–∞ desktop, 15 –Ω–∞ mobile

### –ö–Ω–æ–ø–∫–∏ A-/A+:

- ‚úÖ A- ‚Üí —É–º–µ–Ω—å—à–∞–µ—Ç —Ç–µ–∫—Å—Ç (0.9rem)
- ‚úÖ A+ ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç (1.15rem)
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ ‚Üí –æ—Ç–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º
- ‚úÖ –í–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–µ–Ω–∏–µ: A- –æ—Ç–º–µ–Ω—è–µ—Ç A+, –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage

---

## üîß –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **src/scripts/components/theme.ts**
   - –£–ø—Ä–æ—â–µ–Ω–æ –¥–æ `dark ‚áÑ light`
   - –£–±—Ä–∞–Ω –º–∞—Å—Å–∏–≤ `themeOrder`
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–º—ã –≤ `setTheme()`

2. **build.mjs**
   - –î–æ–±–∞–≤–ª–µ–Ω `<canvas id="sakura-canvas">` –≤ —à–∞–±–ª–æ–Ω –±–ª–æ–≥–∞
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–æ–∫ A-/A+ —Å `wasActive` –ø—Ä–æ–≤–µ—Ä–∫–æ–π

---

## üéØ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –¢–µ–º–∞:

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
# –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É —Ç–µ–º—ã (–ª—É–Ω–∞/—Å–æ–ª–Ω—Ü–µ)
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Dark ‚áÑ Light (–±–µ–∑ –¥—Ä—É–≥–∏—Ö —Ü–≤–µ—Ç–æ–≤)
```

### 2. –°–∞–∫—É—Ä–∞:

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5174/blog/japanese-etiquette/
# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ø–∞–¥–∞—é—â–∏–µ —Ä–æ–∑–æ–≤—ã–µ –ª–µ–ø–µ—Å—Ç–∫–∏
# –ù–∞ mobile (<768px) —Å–∞–∫—É—Ä–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞
```

### 3. –ö–Ω–æ–ø–∫–∏ A-/A+:

```bash
# 1. –ù–∞–∂–º–∏—Ç–µ A+ ‚Üí —Ç–µ–∫—Å—Ç —É–≤–µ–ª–∏—á–∏—Ç—Å—è
# 2. –ù–∞–∂–º–∏—Ç–µ A+ —Å–Ω–æ–≤–∞ ‚Üí —Ç–µ–∫—Å—Ç –≤–µ—Ä–Ω—ë—Ç—Å—è –∫ –Ω–æ—Ä–º–µ
# 3. –ù–∞–∂–º–∏—Ç–µ A- ‚Üí —Ç–µ–∫—Å—Ç —É–º–µ–Ω—å—à–∏—Ç—Å—è
# 4. –ù–∞–∂–º–∏—Ç–µ A+ ‚Üí —Ç–µ–∫—Å—Ç —É–≤–µ–ª–∏—á–∏—Ç—Å—è (A- –æ—Ç–º–µ–Ω–∏—Ç—Å—è)
```

---

## üìä Performance

- –¢–µ–º–∞: 0ms (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è)
- –°–∞–∫—É—Ä–∞: 15-30 –ª–µ–ø–µ—Å—Ç–∫–æ–≤, ~60 FPS
- –ö–Ω–æ–ø–∫–∏: localStorage + CSS classes (0ms)

---

## üöÄ Deployment

```bash
# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞
npm run build

# –†–µ–∑—É–ª—å—Ç–∞—Ç
[build] done: styles.b2c00e0fee.css main.d2c58d7a30.js

# –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –±—Ä–∞—É–∑–µ—Ä–∞
Ctrl + F5 (hard reload)
```

---

## üìù Changelog

**v2.1.1 - 2025-10-03**

- üêõ Fix: Theme toggle —á–µ—Ä–µ–∑ 6 —Ç–µ–º ‚Üí —É–ø—Ä–æ—â–µ–Ω–æ –¥–æ dark/light
- üêõ Fix: –°–∞–∫—É—Ä–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞—Å—å –≤ –±–ª–æ–≥–µ ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω canvas
- üêõ Fix: A-/A+ —Å–ª–µ—Ç–∞–ª–∏ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –Ω–∞–∂–∞—Ç–∏–∏ ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞

**v2.1.0 - 2025-10-03**

- ‚ú® –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Ä–µ–∂–∏–º —á—Ç–µ–Ω–∏—è (8 –∫–Ω–æ–ø–æ–∫)
- ‚ú® –ü–∞–¥–∞—é—â–∞—è —Å–∞–∫—É—Ä–∞ (30 –ª–µ–ø–µ—Å—Ç–∫–æ–≤)
- ‚ú® –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —à–∏—Ä–æ–∫–∞—è –∫–æ–ª–æ–Ω–∫–∞ (‚áî)

---

## üé® Known Issues

–ù–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º. –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.

---

**–ê–≤—Ç–æ—Ä:** GitHub Copilot **–ü—Ä–æ–µ–∫—Ç:** Êó•Êú¨Ë™ûSchool Landing **–õ–∏—Ü–µ–Ω–∑–∏—è:** MIT
